<link rel="Up" href="index.html" title="nosh Guide" />
<link rel="Next" href="chain-loading-cheatsheet.html" title="Logging cheatsheet" />
<link rel="Stylesheet" type="text/css" href="guide.css" title="Guide default style" />
<title>Service management cheatsheet</title>
<h1 class="Ruled">
Service management cheatsheet
</h1>

<p>
These are a few commonly used commands.
For more, see the manual pages of the <a href="commands/service-control.xml"><code>service-control</code></a>, <a href="commands/system-control.xml"><code>system-control</code></a>, <a href="commands/shutdown.xml"><code>shutdown</code></a>, and <a href="commands/rcctl.xml"><code>rcctl</code></a> programs.
For exposition, we here assume that the cron service has its service bundle directory at, or accessible via a symbolic link at, <code>/var/service-bundles/services/gcron</code>.
</p>

<p>
Daemontools-style service management employs direct access to the service bundle directories.
</p>

<p>
OpenBSD-style, systemd-style, and SMF-style service management searches for service bundle directories in several well-known locations.
The cron service (located in such a location) is simply denominated either <code>cron.service</code> or simply <code>cron</code>.
</p>

<p>
Associated log services are conventionally denominated <code>cyclog@</code><i>service-name</i>, and pointed to from the logged service's service bundle by a <code>log</code> symbolic link.
A service and its associated log service may, where such convention is adhered to, be named together using shell brace expansion: <code>{cyclog@,}</code><i>service-name</i>.
</p>

<h2 class="Ruled">
Daemontools-style
</h2>

<dl>

<dt><pre>chkservice /{run,var,etc}/service-bundles/{services,targets}/* /var/local/service-bundles/{services,targets}/*</pre></dt>
<dd>
<p>
Display the statuses of all (standard location) service bundles, in a full screen TUI scrollable table.
</p>
</dd> 

<dt><pre>svstat /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Print the status of the cron service, in human readable short form.
</p>
</dd> 

<dt><pre>svstat --long /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Print the status of the cron service, in human readable long form.
</p>
</dd> 

<dt><pre>svc -u /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Start the cron service, ignoring dependency and conflict information.
</p>
</dd> 

<dt><pre>svc -d /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Stop the cron service.
</p>
</dd> 

<dt><pre>svc -o /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Run the service at least once, starting it if it is not already started.
</p>
</dd> 

<dt><pre>svc -O /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Run the service at most once, not starting it if it is not already started.
</p>
</dd> 

<dt><pre>svc -a /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send an <code>ALRM</code> signal to the cron service.
This is used, for example, to tell logging services to cycle to a new log file.
</p>
</dd> 

<dt><pre>svc -t /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>TERM</code> signal to the cron service.
</p>
</dd> 

<dt><pre>svc -T /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>TERM</code> signal to only the "main" process of the cron service.
</p>
</dd> 

<dt><pre>svc -k /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>KILL</code> signal to the cron service.
</p>
</dd> 

<dt><pre>svc -K /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>KILL</code> signal to only the "main" process of the cron service.
</p>
</dd> 

<dt><pre>svc -h /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>HUP</code> signal to the cron service.
</p>
</dd> 

<dt><pre>svc -H /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Send a <code>HUP</code> signal to only the "main" process of the cron service.
</p>
</dd> 

<dt><pre>svshow /var/service-bundles/services/gcron</pre></dt>
<dd>
<p>
Emit a machine-parseable status of the cron service.
Use the <code>--json</code> option for an alternative machine-parseable form.
</p>
</dd>

</dl>

<h2 class="Ruled">
OpenBSD-style
</h2>

<dl> 

<dt><pre>rcctl get cron</pre></dt>
<dd>
<p>
Print the variables set by the conventional <code>env/</code> environment directory for the cron service.
</p>
</dd> 

<dt><pre>rcctl set cron flags --wibble</pre></dt>
<dd>
<p>
Set the <code>flags</code> variable, set by the conventional <tt>env/</tt> environment directory for the cron service, to <code>--wibble</code>.
</p>
</dd> 

<dt><pre>rcctl status cron</pre></dt>
<dd>
<p>
Print long form human-readable status of the cron service.
This also prints the tail of any associated log, if it is in the conventional place.
</p>
</dd> 

<dt><pre>rcctl start cron</pre></dt>
<dd>
<p>
Start the cron service, following any dependencies.
</p>
</dd> 

<dt><pre>rcctl stop cron</pre></dt>
<dd>
<p>
Stop the cron service.
</p>
</dd> 

<dt><pre>rcctl enable cron</pre></dt>
<dd>
<p>
Set the cron service to auto-start at bootstrap.
</p>
</dd> 

<dt><pre>rcctl disable cron</pre></dt>
<dd>
<p>
Set the cron service to not auto-start at bootstrap.
</p>
</dd>

</dl>

<h2 class="Ruled">
systemd-style
</h2>

<dl> 

<dt><pre>system-control status cron</pre></dt>
<dd>
<p>
Print long form human-readable status of the cron service.
This also prints the tail of any associated log, if it is in the conventional place.
</p>
</dd> 

<dt><pre>system-control start cron</pre></dt>
<dd>
<p>
Start the cron service, following any dependencies.
</p>
</dd> 

<dt><pre>system-control stop cron</pre></dt>
<dd>
<p>
Stop the cron service.
</p>
</dd> 

<dt><pre>system-control preset cron</pre></dt>
<dd>
<p>
Set the cron service to auto-start at bootstrap or not, according to administrator-supplied and package-supplied preset information.
</p>
</dd> 

<dt><pre>system-control reset cron</pre></dt>
<dd>
<p>
Start or stop the cron service according to its enable/disable state, i.e. reset to the configured bootstrap state.
</p>
</dd> 

<dt><pre>system-control enable cron</pre></dt>
<dd>
<p>
Set the cron service to auto-start at bootstrap.
</p>
</dd> 

<dt><pre>system-control disable cron</pre></dt>
<dd>
<p>
Set the cron service to not auto-start at bootstrap.
</p>
</dd> 

<dt><pre>system-control condrestart cron</pre></dt>
<dd>
<p>
Send a <code>TERM</code> signal to restart the cron service.
</p>
</dd> 

<dt><pre>system-control hangup ttylogin@vc1-tty</pre></dt>
<dd>
<p>
Send a <code>HUP</code> signal to the session leader/main process of the ttylogin@vc1-tty service.
</p>
</dd> 

<dt><pre>system-control cat cron</pre></dt>
<dd>
<p>
Print the contents of the various <code>run</code>, <code>restart</code>, and so forth programs of the cron service.
</p>
</dd> 

<dt><pre>system-control poweroff</pre></dt>
<dd>
<p>
Immediately run the system power-off procedure, shutting down any services configured to shut down at power off.
</p>
</dd> 

<dt><pre>system-control print-service-env cron</pre></dt>
<dd>
<p>
Print the variables set by the conventional <code>env/</code> environment directory for the cron service.
</p>
</dd> 

<dt><pre>system-control set-service-env cron flags --wibble</pre></dt>
<dd>
<p>
Set the <code>flags</code> variable, set by the conventional <tt>env/</tt> environment directory for the cron service, to <code>--wibble</code>.
</p>
</dd>

</dl>

<h2 class="Ruled">
Solaris SMF-style
</h2>

<dl>

<dt><pre>svcadm enable cron</pre></dt></dt>
<dd>
<p>
Start (sic!)  the cron service.
</p>
</dd>

<dt><pre>svcadm disable cron</pre></dt></dt>
<dd>
<p>
Stop (sic!) the cron service.
</p>
</dd>

</dl>

<h2 class="Ruled">
Common
</h2>

<dl> 

<dt><pre>setfacl -m u:jim:rx /var/service-bundles/services/gcron{,/log}/supervise
setfacl -m u:jim:rw /var/service-bundles/services/gcron{,/log}/supervise/ok
setfacl -m u:jim:r /var/service-bundles/services/gcron{,/log}/supervise/status</pre></dt>
<dd>
<p>
On systems where these are not world-accessible, grant the user <code>jim</code> access to read the status of the cron service and its associated log service.
</p>
</dd> 

<dt><pre>shutdown -r -g 30</pre></dt>
<dd>
<p>
After a grace period of 30 minutes, during which messages will be broadcast to logged-on users, run the system reboot procedure, shutting down any services configured to shut down at power off.
</p>
</dd>

</dl>
